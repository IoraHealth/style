<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Iora Health's Ruby coding style guidelines" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Iora Health: Ruby code style guide</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <h1 id="project_title">Iora Health</h1>
          <h2 id="project_tagline">Ruby coding guidelines</h2>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
      <h3><a href="#welcome">Welcome!</a></h3>
        <p>Greetings! I hope you have gathered here for some ruby coding
        guidelines as there will be no pictures of cats on this particular
        webpage.</p>
        <p>These sets of guidelines are developed based upon our tastes at Iora
        and are used to drive our internal development practices.  If they 
        suit your needs as well then feel free to make them your own!</p>
        <p>We have borrowed heavily from <a href="https://github.com/bbatsov/ruby-style-guide">https://github.com/bbatsov/ruby-style-guide</a>
        as well as <a href="https://github.com/styleguide/ruby/">https://github.com/styleguide/ruby/</a>
        and <a href="https://github.com/copycopter/style-guide">https://github.com/copycopter/style-guide</a>
        in the creation of our own set of guidelines.<p>

      <h3><a href="#spacing">Layout and Spacing</a></h3>
        <ul>
          <li>
            <p>Try to keep lines fewer than 80 characters.</p>
          </li>
          <li>
            <p>Never, ever leave trailing whitespace.  Let a machine help you
               in this endeavor by setting your text editor to be obnoxious when
               you leave trailing whitespace.</p>
          </li>
          <li>
            <p>Only use spaces.  Never use tabs.  We will publicly shame you if
            your text editor is somehow set to use tabs as this is a problem a
            machine can solve for you.</p>
            <p>Here are people who have abused the tab policy thus far:</p>
            <ul>
              <li>Matthew 'Conksy' Sisto</li>
            </ul>
          </li>
          <li>
            <p>Use two spaces per indentation level.</p>
          <div class="highlight"><pre><code class="ruby"><span class="c1"># good</span>
<span class="k">def</span> <span class="nf">some_method</span>
  <span class="n">do_something</span>
<span class="k">end</span>

<span class="c1"># bad - four spaces</span>
<span class="k">def</span> <span class="nf">some_method</span>
    <span class="n">do_something</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Do not use spaces after <code>(</code>, <code>[</code> or before
            <code>]</code>, <code>)</code>.</p>
            <div class="highlight"><pre><code class="ruby"><span class="n">pickles</span><span class="p">(</span><span class="n">gherkin</span><span class="p">)</span><span class="o">.</span><span class="n">eat</span>
<span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">].</span><span class="n">length</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Do use spaces after <code>{</code> and before <code>}</code>.</p>
            <div class="highlight"><pre><code class="ruby"><span class="o">[</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">12</span><span class="o">].</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">hour</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">hour</span><span class="si">}</span><span class="s2"> O&#39;clock ROCK!!!!&quot;</span> <span class="p">}</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Break up code inside into logical paragraphs.  Some
               great opportunities for breaking up code includes:</p>
            <ul>
              <li>Following a block of variable assignment</li>
              <li>Following a multi-line block</li>
              <li>Before a return statement</li>
            </ul>
            <div class="highlight"><pre><code class="ruby"><span class="c1"># vertical space following variable assignment</span>
<span class="k">def</span> <span class="nf">allowed_in_restaurant?</span>
  <span class="n">shirt</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="n">pants</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">shoes</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="n">shirt</span> <span class="o">&amp;&amp;</span> <span class="n">pants</span> <span class="o">&amp;&amp;</span> <span class="n">shoes</span>
<span class="k">end</span>

<span class="c1"># vertical space following multi-line block</span>
<span class="k">def</span> <span class="nf">rock</span>
  <span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">12</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">hour</span><span class="o">|</span>
    <span class="n">ready_to_rock?</span>
  <span class="k">end</span>

  <span class="n">rock_around_the_clock_tonight</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>We have an obsessive need to vertically align assignment
            statements.  This provides greater clarity and increases the chances
            that Uncle Bob will be our friend some day.</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">def</span> <span class="nf">format_party_time</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
  <span class="n">start_hour</span> <span class="o">=</span> <span class="n">start_time</span><span class="o">.</span><span class="n">strftime</span> <span class="s1">&#39;%h&#39;</span>
  <span class="n">end_hour</span>   <span class="o">=</span> <span class="n">end_time</span><span class="o">.</span><span class="n">strftime</span> <span class="s1">&#39;%h&#39;</span>

  <span class="c1"># Calculate party things here.</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>When you can fit multiple variable assignment statements on one
            line of code; feel free to do so.  You should consider whether your
            variable names are descriptive enough though.  Chances are they are
            not.  Place a space after <code>,</code> and before/after <code>=</code>.</p>
            <div class="highlight"><pre><code class="ruby"><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
</code></pre>
</div>


          </li>
        </ul>
      <h3><a href="#naming">Naming</a></h3>
        <ul>
          <li>
            <p>Use <code>snake_case</code> for methods and variables.</p>
          </li>
          <li>
            <p>Use <code>CamelCase</code> for classes and modules.  Do not keep
            acronyms fully uppercase. ie <code>IpTables</code>.</p>
          </li>
          <li><p>Use <code>SCREAMING_SNAKE_CASE</code> for constants.</p></li>
          <li>
            <p>Ruby allows the use of <code>?</code> in method names so use it
            whenever the method returns a <code>boolean</code> value.</p>
          </li>
          <li>
            <p>Use <code>!</code> to indicate a method performs a dangerous 
            action.  When you define a dangerous method, you must also define
            one that is 'safe' as well.  Typically you should define the 
            'safe' method in relation to the dangerous one:</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Array</span>
  <span class="k">def</span> <span class="nf">flatten_once!</span>
    <span class="n">res</span> <span class="o">=</span> <span class="o">[]</span>
    <span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span>
      <span class="o">[*</span><span class="n">e</span><span class="o">].</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">res</span> <span class="o">&lt;&lt;</span> <span class="n">f</span> <span class="p">}</span>
    <span class="k">end</span>
    <span class="n">replace</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">flatten_once</span>
    <span class="nb">dup</span><span class="o">.</span><span class="n">flatten_once!</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>


            <p>Code above hoisted from <a href="http://dablog.rubypal.com/2007/8/15/bang-methods-or-danger-will-rubyist">David A Black</a>.</p>
          </li>
          <li>
            <p>Classes, modules, methods, and variables should have intention 
            revealing names.  They should, however, be as succintly named as 
            possible without using abbreviations.  If you feel these two 
            suggestions are slightly at odds with another, you would indeed be
            correct.  The key is finding balance.<p>
            <p>Let's go through some examples to make your life slighly easier:</p>
            <ul>
              <li><p>If your class is an implementation of a well known design 
              pattern™ go ahead and chuck that sucker in the name.</p></li>
              <div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">KittenFactory</span>
  <span class="k">def</span> <span class="nf">initialize</span>
    <span class="no">OrdinaryKiten</span><span class="o">.</span><span class="n">new</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>


              <li><p>We strive to avoid smurf-typing.  All smurfs for some reason
              unknown to the staff at Iora have smurf in their name.  Perhaps
              Papa Smurf never heard of namespacing.  Since you have in fact
              discovered the magic of namespacing, use that instead:</p></li>
              <div class="highlight"><pre><code class="ruby"><span class="k">module</span> <span class="nn">Smurf</span>
  <span class="k">class</span> <span class="nc">Papa</span>
    <span class="kp">attr_accessor</span> <span class="ss">:hat</span>
    <span class="vi">@hat</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
  <span class="k">end</span>

  <span class="k">class</span> <span class="nc">Nerdy</span>
    <span class="kp">attr_accessor</span> <span class="ss">:glasses</span>
    <span class="vi">@glasses</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">Smurf</span><span class="o">::</span><span class="no">Papa</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">hat</span> <span class="c1"># =&gt; &#39;red&#39;</span>
<span class="no">Smurf</span><span class="o">::</span><span class="no">Nerdy</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">glasses</span> <span class="c1"># =&gt; true</span>
</code></pre>
</div>


              <li><p>Well known abbreviations are safe to use.  It's pretty safe
              to assume that as web developers we know what HTTP is.  We need to
              treat abbreviations like one word in our above guidelines though:</p>
              <div class="highlight"><pre><code class="ruby">  <span class="k">class</span> <span class="nc">HtmlParser</span>
  <span class="k">end</span>

  <span class="k">module</span> <span class="nn">JsonDelegator</span>
  <span class="k">end</span>
</code></pre>
</div>



              <p>It's a little dicier to use common domain abbreviations though.
              Will a new developer know what BMI is?  Probably.  SPO2?  I don't
              even know what that is and I'm writing this guide.  Our naming
              should be there to clarify the code for every developer.  Not just
              the ones with lots of experience in our problem domain.</p></li>
            </ul>
          </li>
        </ul>
      <h3><a href="#methods">Methods</a></h3>
        <ul>
          <li>
            <p>Methods should do one thing™.  We believe methods that limit
            themselves to doing exactly one thing at a consistent level of
            abstraction leads to more readable and maintainable code.  Some
            general guidelines to encourage methods to do only one thing include:</p>
            <ul>
              <li>Limit methods to at most 8 lines of executable code.</li>
              <li>Limit the number of parameters passed into the method to at 
              most 3.</li>
              <li>Avoid passing in an 'options' hash.  This usually ends up
              violating the above point.</li>
              <li>Prefer to pass in objects over ids.  The notable exception to
              this guideline is when you need to marshal the parameters.</li>
              <li>Limit the number of execution paths to be as simple as possible.</li>
            </ul>
          </li>
          <li>
            <p>Parenthesis are only used on <code>def</code> statements that have
            parameters.</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">def</span> <span class="nf">party_rock</span>
  <span class="n">one_two_shuffle</span> <span class="n">left_foot</span><span class="p">,</span> <span class="n">right_foot</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">one_two_shuffle</span><span class="p">(</span><span class="n">lefty</span><span class="p">,</span> <span class="n">righty</span><span class="p">)</span>
  <span class="n">lefty</span><span class="o">.</span><span class="n">shake_it</span> <span class="o">&amp;&amp;</span> <span class="n">righty</span><span class="o">.</span><span class="n">shake_it</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Break up method definitions by putting blank lines between them.
               Nobody likes a person that fails to break up paragaphs into separate
               lines.  So don't be that guy.
            </p>
            <div class="highlight"><pre><code class="ruby"><span class="k">def</span> <span class="nf">four_score</span>
  <span class="n">talk_forever</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">seven_years_ago</span>
  <span class="n">do_not_get_shot</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Avoid using <code>return</code> unless you absolutely have to.</p>
            <div class="highlight"><pre><code class="ruby"><span class="c1"># superfluous return statement and method in general</span>
<span class="k">def</span> <span class="nf">sexy_and_i_know_it</span>
  <span class="k">return</span> <span class="kp">true</span>
<span class="k">end</span>

<span class="c1"># now only a superfluous method</span>
<span class="k">def</span> <span class="nf">sexy_and_i_know_it</span>
  <span class="kp">true</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Put a space around the default value operator <code>=</code> on
            method definitions.  You put spaces around it everywhere else so it
            only makes sense to do so here!</p>
            <div class="highlight"><pre><code class="ruby">  <span class="k">def</span> <span class="nf">mix_old_fashioned</span><span class="p">(</span><span class="n">booze</span> <span class="o">=</span> <span class="ss">:rye</span><span class="p">,</span> <span class="n">fruit</span> <span class="o">=</span> <span class="ss">:orange</span><span class="p">)</span>
    <span class="n">shake_it_like_a_polaroid</span>
  <span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>While it is possible to place a space between the method
            definition and the parenthesis; I question your sanity for doing
            so.</p>
            <div class="highlight"><pre><code class="ruby"><span class="n">hiring_mistake</span> <span class="p">(</span><span class="kp">true</span><span class="p">)</span> <span class="c1"># This is self documenting code at its best</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Using parenthesis on method invocations is highly contested. The
            issue is that building hard and fast rules around when to use them
            and when exclusion is a solid policy is largely a matter of 
            rearranging the deck chairs on the Titanic.</p>
            <p>If it feels acceptable to omit the parenthesis, feel free to do
            so.  If the code is more readable with them please include them.
            With that said, here are some general guidelines:</p>
            <ul>
              <li>When using a DSL with its own style guideline (RSpec) use
              their preferred style</li>
              <div class="highlight"><pre><code class="ruby"><span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">eq</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">}</span>
<span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="kp">include</span> <span class="s1">&#39;waffles&#39;</span> <span class="p">}</span>
</code></pre>
</div>


              <li>When assigning variables, always include parenthesis</li>
              <div class="highlight"><pre><code class="ruby"><span class="n">x</span> <span class="o">=</span> <span class="no">Math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre>
</div>


            </ul>
          </li>
        </ul>
      <h3><a href="#classes">Classes</a></h3>
        <ul>
          <li>
            <p>We would love it if every class you wrote was <a href="http://en.wikipedia.org/wiki/SOLID_(object-oriented_design)">SOLID</a>.</p>
          </li>
          <li>
            <h6>Structuring Classes</h6>
            <p>Life is really a lot easier for everyone on the development team
            when we set up some common structure and ordering within classes.
            I bet we even wrote a coding style guideline to make our lives
            easier!</p>
            <ul>
              <li><p>If you need to include any modules inside your class, do
              that first.</p></li>
              <li><p><code>CONSTANTS</code> should appear next.</p></li>
              <li><p><code>attr_reader</code>, <code>attr_writter</code>, and
              <code>attr_accessor</code> statments should follow.</p></li>
              <li>
                <p>Next up are public methods.  The first public method you 
                declare should always be <code>initialze</code>.  It is the
                entry point for your class so that makes sense.</p>
                <p>Following that, you should group methods together by usage.
                If <code>foo</code> calls <code>baz</code> then <code>baz</code>
                should be as close to <code>foo</code> as possible.</p>
                <p>Methods should be ordered by how the class is intended to be
                used.  Another developer should be able to read through the
                method definitions of a class and get the gist of the classes
                intention.</p>
                <p>The notable exception to the above rules are class methods.
                We should order them last within the public block.</p>
              </li>
              <li><p>The last section is for private methods.  They should
              follow the above guidelines for private methods.</p></li>
            </ul>
            <p>Let's demonstrate all of the above with one big code block!</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Ninja</span>
  <span class="kp">include</span> <span class="no">SilentWarrior</span>

  <span class="no">ROCK_HARD_AWESOME</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="kp">attr_accessor</span> <span class="ss">:weapon</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">weapon</span><span class="p">)</span>
    <span class="vi">@weapon</span> <span class="o">=</span> <span class="n">weapon</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">sneak_attack</span>
    <span class="k">case</span> <span class="vi">@weapon</span>
    <span class="k">when</span> <span class="no">ThrowingStar</span>
      <span class="n">attack_with_throwing_star</span>
    <span class="k">else</span>
      <span class="n">flip_out_and_stuff</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">attack_with_throwing_star</span>
    <span class="s2">&quot;YOU&#39;VE BEEN NINJADDDDDD&quot;</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">flip_out_and_stuff</span>
    <span class="s2">&quot;YOU HAVE ALSO BEEN NINJADDDDD&quot;</span>
    <span class="n">disappear_into_darkness</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">create_with_throwing_star</span><span class="p">(</span><span class="n">throwing_star_name</span> <span class="o">=</span> <span class="s1">&#39;Pinkie Pie&#39;</span><span class="p">)</span>
    <span class="n">weapon</span> <span class="o">=</span> <span class="no">ThrowingStar</span> <span class="nb">name</span><span class="p">:</span> <span class="n">throwing_star_name</span>

    <span class="no">Ninja</span><span class="o">.</span><span class="n">new</span> <span class="n">weapon</span>
  <span class="k">end</span>

  <span class="kp">private</span>
  <span class="k">def</span> <span class="nf">disappear_into_darkness</span>
    <span class="n">throw_powder</span> <span class="c1">#implemented in SilentWarrior</span>
    <span class="s2">&quot;LOLOLOLOL INVISIBLE&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>It's generaly best to use <code>self.method</code> instead of
            <code>Class.method</code> when declaring class methods.  The common
            wisdom surrounding this statement revolves around the fact that it
            is harder to perform a rename class refactoring™ when you use the
            former style.  Those people should probably should learn how to
            use a more powerful text editor but we generally defer to this
            style as it causes no harm.</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Ninja</span>
  <span class="c1"># apparently string replacement is hard here</span>
  <span class="k">def</span> <span class="nc">Ninja</span><span class="o">.</span><span class="nf">create_with_claw</span>
    <span class="no">Ninja</span><span class="o">.</span><span class="n">new</span> <span class="no">Claw</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;doris&#39;</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Ninja</span>
  <span class="c1"># so much more resilient</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">create_with_claw</span>
    <span class="no">Ninja</span><span class="o">.</span><span class="n">new</span> <span class="no">Claw</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;doris&#39;</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Don't declare a block of class methods with 
            <code>class << self</code>.  The last time I saw someone attempt
            this was around 2007 so I'm not sure why this one needs to still
            be on the rulebooks.</p>
            <img src="images/never_forget.gif"</img>
          </li>
          <li>
            <p>The usage of class variables (<code>@@</code>) is highly
            discouraged.  Why you ask?  Because when you choose to use 
            inheritence over composition for some reason all classes within the
            hierarchy share the same variable.  Most of the time you wouldn't
            expect that behavior.</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Cat</span>
  <span class="vc">@@capable_of_purring</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">purr</span>
    <span class="nb">puts</span> <span class="s2">&quot;prrrrrrrrrr&quot;</span> <span class="k">if</span> <span class="vc">@@capable_of_purring</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Lion</span> <span class="o">&lt;</span> <span class="no">Cat</span>
  <span class="vc">@@capable_of_purring</span> <span class="o">=</span> <span class="kp">false</span>
<span class="k">end</span>

<span class="no">Cat</span><span class="o">.</span><span class="n">purr</span> <span class="c1"># =&gt; prints nothing :(</span>
</code></pre>
</div>


            <p>But how can we set class attributes?  Instead create
            <code>attr_reader</code>, <code>attr_writter</code>, 
            <code>attr_accessor</code> methods on the class level like so:</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">Cat</span>
  <span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span>
    <span class="kp">attr_reader</span> <span class="ss">:capable_of_purring</span>
  <span class="k">end</span>
  <span class="vi">@capable_of_purring</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="k">def</span> <span class="nf">purr</span>
    <span class="n">pust</span> <span class="s2">&quot;prrrrr&quot;</span> <span class="k">if</span> <span class="vi">@capable_of_purring</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Lion</span> <span class="o">&lt;</span> <span class="no">Cat</span>
  <span class="vi">@capable_of_purring</span> <span class="o">=</span> <span class="kp">false</span>
<span class="k">end</span>

<span class="no">Cat</span><span class="o">.</span><span class="n">purr</span> <span class="c1"># =&gt; &quot;prrrr&quot;</span>
<span class="no">Lion</span><span class="o">.</span><span class="n">purr</span> <span class="c1"># =&gt; outputs nothing! yay.</span>
</code></pre>
</div>


          </li>
        </ul>
      <h3><a href="#conditionals">Conditionals</a></h3>
        <ul>
          <li>
            <p>The ternary operator hides multiple execution paths in one
            handy little line.  It should be avoided except when the conditions
            are trivial.  Consider using a multiline <code>if</code>/<code>else</code>
            statement instead.</p>
            <div class="highlight"><pre><code class="ruby"><span class="c1"># Too much going on</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">4</span> <span class="p">:</span> <span class="n">number</span> <span class="o">/</span> <span class="mi">3</span>

<span class="c1"># Just enough going on</span>
<span class="n">result</span> <span class="o">=</span> <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
  <span class="n">number</span> <span class="o">%</span> <span class="mi">4</span>
<span class="k">else</span>
  <span class="n">number</span> <span class="o">/</span> <span class="mi">4</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Use the modifier <code>if</code>/<code>unless</code> for single
            statements.</p>
            <div class="highlight"><pre><code class="ruby"><span class="c1"># Not the greatest</span>
<span class="k">def</span> <span class="nf">send_tweet</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">140</span>
    <span class="no">TwitterStream</span><span class="o">.</span><span class="n">enqueue</span> <span class="n">message</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># Better</span>
<span class="k">def</span> <span class="nf">send_tweet</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
  <span class="no">TwitterStream</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">140</span>
<span class="k">end</span>

<span class="c1"># Bettererer</span>
<span class="k">def</span> <span class="nf">send_tweet</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
  <span class="no">TwitterStrem</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">usable_on_twitter?</span>
<span class="k">end</span>
</code></pre>
</div>


          <li>
            <p>Indent <code>when</code> at the same level as <code>case</code>.
            The <code>else</code> statement belongs on the same level of
            indentation as <code>when</code> and <code>case</code>.</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">case</span>
<span class="k">when</span> <span class="n">song</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Misty&#39;</span>
  <span class="nb">puts</span> <span class="s1">&#39;Not again!&#39;</span>
<span class="k">when</span> <span class="n">song</span><span class="o">.</span><span class="n">duration</span> <span class="o">&gt;</span> <span class="mi">120</span>
  <span class="nb">puts</span> <span class="s1">&#39;Too long!&#39;</span>
<span class="k">when</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">hour</span> <span class="o">&gt;</span> <span class="mi">21</span>
  <span class="nb">puts</span> <span class="s2">&quot;It&#39;s too late&quot;</span>
<span class="k">else</span>
  <span class="n">song</span><span class="o">.</span><span class="n">play</span>
<span class="k">end</span>

<span class="n">kind</span> <span class="o">=</span> <span class="k">case</span> <span class="n">year</span>
       <span class="k">when</span> <span class="mi">1850</span><span class="o">.</span><span class="n">.</span><span class="mi">1889</span> <span class="k">then</span> <span class="s1">&#39;Blues&#39;</span>
       <span class="k">when</span> <span class="mi">1890</span><span class="o">.</span><span class="n">.</span><span class="mi">1909</span> <span class="k">then</span> <span class="s1">&#39;Ragtime&#39;</span>
       <span class="k">when</span> <span class="mi">1910</span><span class="o">.</span><span class="n">.</span><span class="mi">1929</span> <span class="k">then</span> <span class="s1">&#39;New Orleans Jazz&#39;</span>
       <span class="k">when</span> <span class="mi">1930</span><span class="o">.</span><span class="n">.</span><span class="mi">1939</span> <span class="k">then</span> <span class="s1">&#39;Swing&#39;</span>
       <span class="k">when</span> <span class="mi">1940</span><span class="o">.</span><span class="n">.</span><span class="mi">1950</span> <span class="k">then</span> <span class="s1">&#39;Bebop&#39;</span>
       <span class="k">else</span> <span class="s1">&#39;Jazz&#39;</span>
       <span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Pairing <code>unless</code> with an <code>else</code> is bad
            news bears.  It's possible to swap the statement into an <code>if</code>
            /<code>else</code> by reversing the order of the conditionals and it
            prevents our minds from melting.</p>
            <div class="highlight"><pre><code class="ruby"><span class="c1"># The priorities here seem to be all wrong</span>
<span class="k">unless</span> <span class="n">party_time?</span>
  <span class="n">listen_to_jazz_music</span>
<span class="k">else</span>
  <span class="n">rock_out_with_reckless_abandon</span>
<span class="k">end</span>

<span class="c1"># Company culture upheld!!!</span>
<span class="k">if</span> <span class="n">party_time?</span>
  <span class="n">rock_out_with_reckless_abandon</span>
<span class="k">else</span>
  <span class="n">listen_to_jazz_music</span>
<span class="k">end</span>
</code></pre>
</div>


            <p><code>unless</code> is used to clarify exceptional cases.  When
            there is both a positive and negative case it loses all clarity. As
            a company we want to hear the good news before the bad news in our 
            conditional statements.</p>
          </li>
          <li>
            <p>It is rather possible to assign values in if statements.  Where
            it starts going downhill though is that <code>=</code> is one
            keystroke away from <code>==</code> and the intent of the code is
            not easily gleaned without a deeper code dive.</p>

            <p>In order to alleviate this burden upon the future reader of your
            code it is best to encapsulate assignment within an if statement
            with parenthesis.</p>
            <div class="highlight"><pre><code class="ruby"><span class="c1"># Checking equality</span>
<span class="k">if</span> <span class="n">pants_off_dance_off</span> <span class="o">==</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span>
  <span class="n">take_pants_off</span>
<span class="k">end</span>

<span class="c1"># Assigning a value and checking equality</span>
<span class="k">if</span> <span class="p">(</span><span class="n">pants_off_dance_off</span> <span class="o">=</span> <span class="no">Party</span><span class="o">.</span><span class="n">party_o_clock</span><span class="p">)</span> <span class="o">==</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span>
  <span class="no">PartyQueue</span><span class="o">.</span><span class="n">enqueue</span> <span class="n">pants_off_dance_off</span>
<span class="k">end</span>
</code></pre>
</div>


          </li>
          <li>
            <p>Using <code>unless</code> is a lot easier on the eyes than 
            <code>if !</code>.</p>
            <div class="highlight"><pre><code class="ruby"><span class="c1"># My simple mind is unable to parse this statement</span>
<span class="n">wait_impatiently</span> <span class="k">if</span> <span class="o">!</span><span class="n">party_time?</span>

<span class="c1"># Oh I need to wait for party time!</span>
<span class="n">wait_impatiently</span> <span class="k">unless</span> <span class="n">party_time?</span>
</code></pre>
</div>


          </li>
        </ul>
      <h3><a href="#language-trivia">Language Trivia</a></h3>
        <p>Like any programming language, Ruby has both good and bad parts.  It
        would not be a coding guideline document if we didn't go over the parts
        of the language we should just flat out avoid in our day-to-day work.</p>
        <ul>
          <li>
            <p>The <code>for</code> loop should be avoided at all costs. 
            Internally it is implemented as an <code>each</code> loop but without
            properly scoping the block variable.</p>
            <div class="highlight"><pre><code class="ruby"><span class="k">for</span> <span class="n">num</span> <span class="k">in</span> <span class="o">[</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">12</span><span class="o">]</span> <span class="k">do</span>
  <span class="nb">puts</span> <span class="n">num</span> <span class="o">%</span> <span class="mi">2</span>
<span class="k">end</span>

<span class="c1"># This is just plain wrong.</span>
<span class="nb">puts</span> <span class="n">num</span> <span class="c1"># =&gt; 12</span>

<span class="o">[</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">12</span><span class="o">].</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">num</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">num</span> <span class="o">%</span> <span class="mi">2</span> <span class="p">}</span>

<span class="nb">puts</span> <span class="n">num</span> <span class="c1"># =&gt; NoMethodError</span>
</code></pre>
</div>


          </li>
          <li>
            <p>The use of <code>then</code> is likely to happen when you think
            you are writing coffescript code and not ruby.  We write a heck of
            a lot of coffescript so I do not die on the inside when you use it.</p>
            <p>There are are two failed casses when using <code>then</code>:</p>
            <ul>
              <li>On ending a multiline <code>if</code> statement</li>
              <div class="highlight"><pre><code class="ruby"><span class="k">if</span> <span class="n">party_time?</span> <span class="k">then</span>
  <span class="c1"># IT ISNT PARTY TIME BECAUSE I HAVE ENDED YOU</span>
<span class="k">end</span>
</code></pre>
</div>


              <li>As a verbose ternary operator</li>
              <div class="highlight"><pre><code class="ruby"><span class="k">if</span> <span class="n">coffeescript?</span> <span class="k">then</span> <span class="sr">/*it isn&#39;t jerk*/</span> <span class="k">else</span> <span class="nb">puts</span> <span class="s2">&quot;ruh-roh&quot;</span> <span class="k">end</span>
</code></pre>
</div>


            </ul>
            <p>In the former case you've written an unecessary statement.  In
            the latter case you are wasting all of our time because people that
            made coffeescript were too lazy to write a proper ternary operator.</p>
          </li>
          <li>
            <p><code>and</code> and <code>or</code> are not equivalent to
            <code>&&</code> and <code>||</code>.  They take a much lower precedence
            and chances are that your code will not do what you'd like it to do. 
            It is best to avoid <code>and</code> and <code>or</code> altogether 
            despite the fact that your code may appear more readable.</p>
          </li>
          <li>
            <p>Use the nilguard (<code>||=</code>) freely to memoize variables.
            There are exceptions to when the nilguard will bite you in the butt:</p>
            <ul>
              <li>When <code>nil</code> is a valid value (duhhhhhhhh)</li>
              <li>When <code>false</code> is a valid value</li>
              <div class="highlight"><pre><code class="ruby"><span class="c1"># Future arrest pending</span>
<span class="n">pants_on</span> <span class="o">=</span> <span class="kp">false</span>

<span class="k">def</span> <span class="nf">can_go_outside?</span><span class="p">(</span><span class="n">pants_status</span><span class="p">)</span>
  <span class="n">pants_status</span> <span class="o">||=</span> <span class="kp">true</span>

  <span class="n">pants_status</span>
<span class="k">end</span>

<span class="n">can_go_outside?</span> <span class="n">pants_on</span> <span class="c1"># =&gt; true</span>

<span class="c1"># Safety from prosecution</span>
<span class="k">def</span> <span class="nf">can_go_outside?</span><span class="p">(</span><span class="n">pants_status</span><span class="p">)</span>
  <span class="n">pants_status</span> <span class="o">=</span> <span class="kp">true</span> <span class="k">if</span> <span class="n">pants_status</span><span class="o">.</span><span class="n">nil?</span>

  <span class="n">pants_status</span>
<span class="k">end</span>

<span class="n">can_go_outside?</span> <span class="n">pants_on</span> <span class="c1"># =&gt; false</span>
</code></pre>
</div>


            </ul>
          </li>
          <li>
          <p>Use <code>_</code> for unused block variables.</p>
          <div class="highlight"><pre><code class="ruby"><span class="n">result</span> <span class="o">=</span> <span class="nb">hash</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">_</span><span class="p">,</span><span class="n">v</span><span class="o">|</span> <span class="n">v</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span>
</code></pre>
</div>


          </li>
        </ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

  </body>
</html>
